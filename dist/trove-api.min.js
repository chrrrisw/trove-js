/*! trove-api 01-10-2015 */
!function(a,b,c){"use strict";a.trove_key="",a.init=function(b){a.trove_key=b};var d={BOOK:"book",PIC:"picture",ART:"article",MUS:"music",MAP:"map",COLL:"collection",NEWS:"newspaper",LIST:"list",ALL:"all"};a.ZONE=d;var e={FORMAT:"format",DECADE:"decade",YEAR:"year",MONTH:"month",LANGUAGE:"language",AVAILABILITY:"availability",AUSTRALIAN:"australian",OCCUPATION:"occupation",ZOOM:"zoom",VENDORDB:"vendordb",VENDOR:"vendor",AUDIENCE:"audience",TITLE:"title",CATEGORY:"category",ILLUSTRATED:"illustrated",ILLTYPE:"illtype",WORD:"word",ALL:"all"};a.FACETS=e;var f={FORMAT:"l-format",DECADE:"l-decade",YEAR:"l-year",MONTH:"l-month",LANGUAGE:"l-language",AVAILABILITY:"l-availability",AUSTRALIAN:"l-australian",OCCUPATION:"l-occupation",ZOOM:"l-zoom",VENDORDB:"l-vendordb",VENDOR:"l-vendor",AUDIENCE:"l-audience",TITLE:"l-title",CATEGORY:"l-category",ILLUSTRATED:"l-illustrated",ILLTYPE:"l-illtype",WORD:"l-word",ALL:"l-all"};a.LIMITS=f;var g={DATEDESC:"datedesc",DATEASC:"dateasc",RELEVANCE:"relevance"};a.SORTBY=g;var h={FULL:"full",BRIEF:"brief"};a.RECLEVEL=h;var i={TAGS:"tags",COMMENTS:"comments",LISTS:"lists",HOLDINGS:"holdings",LINKS:"links",SUBSCRIBINGLIBS:"subscribinglibs",WORKVERSIONS:"workversions",ARTICLETEXT:"articletext",YEARS:"years",LISTITEMS:"listitems",ALL:"all"};a.INCLUDE=i;var j={ARTICLE:"Article",ADVERTISING:"Advertising",LISTS:"Detailed lists, results, guides",FAMILY_NOTICES:"Family Notices",LITERATURE:"Literature"};a.CATEGORIES=j;var k={people:"people",list:"list",newspaper:"article",article:"work",collection:"work",book:"work",picture:"work",map:"work",music:"work"};a.SEARCH_RECORDS=k;var l={};a.SEARCH_CONSTRUCTORS=l;var m="http://api.trove.nla.gov.au/",n={WORK:"work/",NEWS:"newspaper/",LIST:"list/"};a.RECORD_TYPE=n;var o={WORK:m+n.WORK,LIST:m+n.LIST,NP_ARTICLE:m+n.NEWS,NP_TITLE:m+n.NEWS+"title/",NP_TITLES:m+n.NEWS+"titles",QUERY:m+"result"};a.API=o}(window.Trove=window.Trove||{},jQuery),function(a,b,c){"use strict";function d(a){console.log("Creating Search"),b.extend(this,a),this.response=c,this.items={},this._last_search=c,this.facets=[],this.limits={}}d.prototype.process_results=function(b){console.log("Got Search Query");var d,e;this.items={},this.response=b.response;for(var f in this.response.zone){e=this.response.zone[f].name,this.items[e]=[],d=this.response.zone[f].records[a.SEARCH_RECORDS[e]];for(var g in d)this.items[e].push(new a.SEARCH_CONSTRUCTORS[e](d[g]))}this.done!==c&&this.done(this)},d.prototype.process_fail=function(a,b,d){console.error(b),this.fail!==c&&this.fail(this)},d.prototype.remove_facet=function(a){-1!=this.facets.indexOf(a)&&this.facets.splice(this.facets.indexOf(a),1)},d.prototype.add_facet=function(a){this.facets.push(a)},d.prototype.clear_date_range_limit=function(){this.limits.decade!==c&&delete this.limits.decade,this.limits.year!==c&&delete this.limits.year,this.limits.month!==c&&delete this.limits.month},d.prototype.limit_date_range=function(a){var b=a.split("-");b.length>=1&&(3==b[0].length?this.limits.decade=b[0]:4==b[0].length&&(this.limits.decade=b[0].substr(0,3),this.limits.year=b[0])),b.length>=2&&(this.limits.month=b[1])},d.prototype.query=function(d){if(console.log("Querying Search"),d===c)return void console.error("options is undefined");var e=a.ZONE.ALL;"string"==typeof d.zones?e=d.zones:Array.isArray(d.zones)?e=d.zones.join(","):"string"==typeof this.zones?e=this.zones:Array.isArray(this.zones)&&(e=this.zones.join(","));var f={key:a.trove_key,encoding:"json",zone:e,q:d.terms||this.terms,s:0,n:20};d.start!==c&&(f.s=d.start),d.number!==c&&(f.n=d.number),d.sort!==c&&(f.sortby=d.sort),d.reclevel!==c&&(f.reclevel=d.reclevel),"string"==typeof d.includes?f.include=d.includes:Array.isArray(d.includes)?f.include=d.includes.join(","):"string"==typeof this.includes?f.include=this.includes:Array.isArray(this.includes)&&(f.include=this.includes.join(",")),this.facets.length>0&&(f.facet=this.facets.join(","));var g=Object.keys(this.limits);if(g.length>0)for(var h in g)f["l-"+g[h]]=this.limits[g[h]];this._last_search=f,b.ajax({dataType:"jsonp",url:a.API.QUERY,data:f,context:this}).done(this.process_results).fail(this.process_fail)},d.prototype.requery=function(d,e){this._last_search!==c&&(this._last_search.s=this._last_search.s+e,b.ajax({dataType:"jsonp",url:a.API.QUERY,data:this._last_search,context:this}).done(this.process_results).fail(this.process_fail))},d.prototype.next=function(a){this._last_search!==c&&this.requery(a,this._last_search.n)},d.prototype.previous=function(a){this._last_search!==c&&this.requery(a,-this._last_search.n)},d.prototype.newspaper_articles=function(){return[]},a.Search=d}(window.Trove=window.Trove||{},jQuery),function(a,b,c){"use strict";function d(a){b.extend(this,a)}a.List=d,a.SEARCH_CONSTRUCTORS.list=d}(window.Trove=window.Trove||{},jQuery),function(a,b,c){"use strict";function d(a){console.log("Creating Person"),b.extend(this,a)}a.Person=d,a.SEARCH_CONSTRUCTORS.people=d}(window.Trove=window.Trove||{},jQuery),function(a,b,c){"use strict";function d(a){console.log("Creating Article"),b.extend(this,a)}a.Article=d,a.SEARCH_CONSTRUCTORS.article=d}(window.Trove=window.Trove||{},jQuery),function(a,b,c){"use strict";function d(a){console.log("Creating Picture"),b.extend(this,a)}a.Picture=d,a.SEARCH_CONSTRUCTORS.picture=d}(window.Trove=window.Trove||{},jQuery),function(a,b,c){"use strict";function d(a){console.log("Creating Book"),b.extend(this,a)}a.Book=d,a.SEARCH_CONSTRUCTORS.book=d}(window.Trove=window.Trove||{},jQuery),function(a,b,c){"use strict";function d(a){console.log("Creating Map"),b.extend(this,a)}a.Map=d,a.SEARCH_CONSTRUCTORS.map=d}(window.Trove=window.Trove||{},jQuery),function(a,b,c){"use strict";function d(a){console.log("Creating Music"),b.extend(this,a)}a.Music=d,a.SEARCH_CONSTRUCTORS.music=d}(window.Trove=window.Trove||{},jQuery),function(a,b,c){"use strict";function d(a){console.log("Creating Collection"),b.extend(this,a)}a.Collection=d,a.SEARCH_CONSTRUCTORS.collection=d}(window.Trove=window.Trove||{},jQuery),function(a,b,c){"use strict";function d(a){console.log("Creating NewspaperArticle");var d;a.init!==c&&(d=a.init,delete a.init),b.extend(this,a),d!==c&&this.get({identifier:d,done:this.done})}d.prototype.get=function(d){console.log("Getting NewspaperArticle");var e={key:a.trove_key,encoding:"json"};b.ajax({dataType:"jsonp",url:a.API.NP_ARTICLE+d.identifier,data:e,context:this}).done(function(a){console.log("Got NewspaperArticle"),b.extend(this,a.article),d.done!==c?d.done(this):this.done!==c&&this.done(this)})},d.prototype.get_newspaper=function(a){return console.log("Get Newspaper for Article"),this.title!==c&&this.title.id!==c?new Newspaper({init:this.title.id,done:a.done||this.done}):void 0},a.NewspaperArticle=d,a.SEARCH_CONSTRUCTORS.newspaper=d}(window.Trove=window.Trove||{},jQuery),function(a,b,c){"use strict";function d(a){console.log("Creating Newspaper");var d;a.init!==c&&(d=a.init,delete a.init),b.extend(this,a),d!==c&&this.get({identifier:d,done:this.done})}d.prototype.get=function(d){console.log("Getting Newspaper");var e={key:a.trove_key,encoding:"json"};b.ajax({dataType:"jsonp",url:a.API.NP_TITLE+d.identifier,data:e,context:this}).done(function(a){console.log("Got Newspaper"),b.extend(this,a.newspaper),d.done!==c?d.done(this):this.done!==c&&this.done(this)})},a.Newspaper=d}(window.Trove=window.Trove||{},jQuery),function(a,b,c){"use strict";function d(a){console.log("Creating NewspaperList"),b.extend(this,a),this.newspapers=[],this.state!==c&&this.get({state:this.state})}d.prototype.processGet=function(a){for(var b in a.response.records.newspaper)console.dir(a.response.records.newspaper[b]),this.newspapers.push(new Newspaper(a.response.records.newspaper[b]));console.log("total = "+a.response.records.total)},d.prototype.get=function(d){console.log("Getting NewspaperList");var e={key:a.trove_key,encoding:"json"};d!==c&&d.state!==c&&(e.state=d.state),b.ajax({dataType:"jsonp",url:a.API.NP_TITLES,data:e,context:this}).done(this.processGet)},a.NewspaperList=d}(window.Trove=window.Trove||{},jQuery);